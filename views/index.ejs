<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Upload Dark Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "ui-sans-serif", "system-ui"],
            },
            colors: {
              dark: {
                50: "#1a2233",
                100: "#1e2635",
                200: "#253242",
                300: "#2d3a4b",
                400: "#364354",
                500: "#3e4a5b",
                600: "#465363",
                700: "#4e5a6b",
                800: "#566273",
                900: "#5e6a7b",
              },
              brand: {
                50: "#2c7be5",
                100: "#2c7be5",
                200: "#2c7be5",
                300: "#2c7be5",
                400: "#2c7be5",
                500: "#2c7be5",
                600: "#1a5ee8",
                700: "#0d43a0",
                800: "#0a347f",
                900: "#072457",
              },
            },
          },
        },
      };
    </script>
    <style>
      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #2d3a4b;
      }
      ::-webkit-scrollbar-thumb {
        background: #465363;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #5e6a7b;
      }
    </style>
  </head>
  <body class="bg-dark-50 text-gray-200 font-sans antialiased">
    <div class="container mx-auto px-4 py-12 max-w-2xl">
      <div
        class="bg-dark-100 shadow-2xl rounded-2xl border border-dark-300 p-8"
      >
        <div class="text-center mb-8">
          <h1 class="text-3xl font-bold text-brand-50 mb-2">
            PDF Upload Center
          </h1>
          <p class="text-gray-400 text-sm">
            Effortlessly upload and manage your documents
          </p>
        </div>

        <form id="uploadForm" enctype="multipart/form-data" class="space-y-6">
          <div class="grid grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2"
                >Grade</label
              >
              <select
                id="grade"
                name="grade"
                class="w-full px-3 py-2 bg-dark-200 border border-dark-400 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 transition duration-300"
              >
                <% for(let i = 1; i <= 13; i++) { %>
                <option value="<%= i %>">Grade <%= i %></option>
                <% } %>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2"
                >Subject</label
              >
              <select
                id="subject"
                name="subject"
                class="w-full px-3 py-2 bg-dark-200 border border-dark-400 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 transition duration-300"
              >
                <option value="Mathematics">Mathematics</option>
                <option value="Science">Science</option>
                <option value="History">History</option>
                <option value="Geography">Geography</option>
                <option value="English">English</option>
                <option value="Physics">Physics</option>
                <option value="Chemistry">Chemistry</option>
                <option value="Biology">Biology</option>
              </select>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2"
              >File Name</label
            >
            <input
              type="text"
              id="fileName"
              name="fileName"
              class="w-full px-3 py-2 bg-dark-200 border border-dark-400 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 transition duration-300"
              required
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2"
              >Select PDFs</label
            >
            <div
              id="dropArea"
              class="relative flex items-center justify-center border-2 border-dashed border-dark-400 rounded-lg p-6 cursor-pointer hover:border-brand-500 transition duration-300 group"
            >
              <input
                type="file"
                id="pdfs"
                name="pdfs"
                multiple
                accept="application/pdf"
                class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
              />

              <div class="text-center">
                <svg
                  class="mx-auto w-12 h-12 text-dark-600 group-hover:text-brand-50 transition duration-300"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"
                  />
                </svg>
                <p class="mt-2 text-sm text-gray-500 group-hover:text-gray-300">
                  Drag and drop PDF files or
                  <span class="text-brand-50 font-semibold"
                    >click to upload</span
                  >
                </p>
                <p
                  id="fileNameDisplay"
                  class="text-brand-50 text-sm mt-2 hidden"
                ></p>
              </div>
            </div>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-300 mb-2"
              >Secret Key</label
            >
            <input
              type="text"
              id="key"
              name="key"
              class="w-full px-3 py-2 bg-dark-200 border border-dark-400 text-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 transition duration-300"
              required
            />
          </div>

          <button
            type="submit"
            class="w-full bg-brand-500 text-white font-semibold py-3 rounded-lg hover:bg-brand-600 transition duration-300 ease-in-out transform hover:-translate-y-1 shadow-lg hover:shadow-xl"
          >
            Upload Files
          </button>
        </form>

        <div
          id="progressWrapper"
          class="flex items-center justify-center mt-6 hidden"
        >
          <div
            class="animate-spin rounded-full h-8 w-8 border-t-2 border-brand-50"
          ></div>
        </div>

        <div
          id="popup"
          class="fixed top-6 right-6 text-white px-6 py-3 rounded-lg shadow-lg hidden transition-all duration-300"
        ></div>

        <div class="mt-6 border-t border-dark-400 pt-4">
          <h3 class="text-lg font-semibold text-gray-200 mb-3">
            Uploaded Files
          </h3>
          <ul
            id="uploadedFilesList"
            class="space-y-2 max-h-48 overflow-y-auto rounded-lg"
          ></ul>
        </div>
      </div>
    </div>

    <script>
      const fileInput = document.getElementById("pdfs");
      const dropArea = document.getElementById("dropArea");
      const fileNameDisplay = document.getElementById("fileNameDisplay");

      // Handle file selection
      fileInput.addEventListener("change", function () {
        if (fileInput.files.length > 0) {
          fileNameDisplay.textContent =
            fileInput.files.length === 1
              ? fileInput.files[0].name
              : `${fileInput.files.length} files selected`;
          fileNameDisplay.classList.remove("hidden");
        }
      });

      // Drag & Drop functionality
      dropArea.addEventListener("dragover", (event) => {
        event.preventDefault();
        dropArea.classList.add("border-brand-500");
      });

      dropArea.addEventListener("dragleave", () => {
        dropArea.classList.remove("border-brand-500");
      });

      dropArea.addEventListener("drop", (event) => {
        event.preventDefault();
        dropArea.classList.remove("border-brand-500");
        fileInput.files = event.dataTransfer.files;
        fileInput.dispatchEvent(new Event("change"));
      });

      // Handle form submission
      document
        .getElementById("uploadForm")
        .addEventListener("submit", async (event) => {
          event.preventDefault();
          const formData = new FormData(event.target);
          console.log(formData);

          const progressWrapper = document.getElementById("progressWrapper");
          const popup = document.getElementById("popup");
          const uploadedFilesList =
            document.getElementById("uploadedFilesList");

          // Show progress spinner
          progressWrapper.classList.remove("hidden");

          const xhr = new XMLHttpRequest();
          xhr.open("POST", "/upload", true);

          xhr.onload = function () {
            progressWrapper.classList.add("hidden");
            if (xhr.status === 200) {
              const response = JSON.parse(xhr.responseText);
              showPopup("Files uploaded successfully!", "bg-green-600");

              // Display uploaded files as download links
              response.uploadedFiles.forEach((fileUrl) => {
                const listItem = document.createElement("li");
                listItem.innerHTML = `
                                <a href="${fileUrl}" target="_blank" class="flex items-center justify-between bg-dark-200 hover:bg-dark-300 px-4 py-2 rounded-lg transition duration-300">
                                    <span class="text-brand-50 font-medium truncate">${fileUrl
                                      .split("/")
                                      .pop()}</span>
                                    <svg class="w-5 h-5 text-brand-50" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                </a>`;
                uploadedFilesList.appendChild(listItem);
              });
            } else {
              showPopup("Error uploading files!", "bg-red-600");
            }
          };

          xhr.send(formData);
        });

      function showPopup(message, bgColor) {
        const popup = document.getElementById("popup");
        popup.textContent = message;
        popup.className = `fixed top-6 right-6 text-white px-6 py-3 rounded-lg shadow-lg ${bgColor} z-50`;
        popup.classList.remove("hidden");

        setTimeout(() => {
          popup.classList.add("hidden");
        }, 3000);
      }
    </script>
  </body>
</html>
